<?php

class SSLOentChunk extends SSLChunk
{
    /**
     * @var array of SSLChunk
     */
    protected $chunks = array();
    
    /**
     * @var SSLAdatChunk
     */
    protected $adat_chunk = null;
    
    public function __construct($data)
    {
        parent::__construct('oent', '');
        
        $cp = new SSLChunkParser($data);
        while($cp->hasMore())
        {
            $chunk = $cp->parse();
            $this->chunks[] =& $chunk;
            if($chunk instanceof SSLAdatChunk)
            {      
                $this->adat_chunk =& $chunk;
            }
        }
    }
    
    protected function chunkDebugBody($indent=0)
    {
        $string = '';
        foreach($this->chunks as $chunk)
        {
            $string .= $chunk->toString($indent+1);
        }
        return $string;
    }

    /**
     * @return array
     */
    public function getData()
    {
        if(isset($this->adat_chunk))
        {
            return $this->adat_chunk->getData();
        }
        
        throw new OutOfBoundException('This oent chunk contains no adat chunk');
    }    
}